---
sidebar: sidebar 
permalink: vcp_task_protect_snapshots_volume.html 
summary: データのコピーを作成し、必要な場所に保存できます。 
keywords: netapp, hci, vcp, vcenter, element, protect, snapshots, clone, backup, amazon, s3, openstack, swift 
---
= vCenter Server でボリューム Snapshot を作成および管理します
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
を作成しています https://docs.netapp.com/us-en/hci/docs/concept_hci_dataprotection.html#volume-snapshots-for-data-protection["ボリューム Snapshot"] ボリュームのポイントインタイムコピーを作成します。このプロセスは少量のシステムリソースとスペースしか消費しないため、クローニングよりも短い時間で Snapshot を作成できます。

Snapshot を使用して、 Snapshot が作成された時点の状態にボリュームをロールバックできます。ただし、 Snapshot はボリュームメタデータの単なるレプリカであるため、マウントや書き込みはできません。

.オプション（ Options ）
*  a volume snapshot
*  volume snapshot details
*  a volume from a snapshot
*  back a volume to a snapshot
*  up a volume snapshot to an external object store
*  a volume snapshot




== ボリューム Snapshot を作成します

アクティブボリュームの Snapshot を作成すると、任意の時点におけるボリュームイメージを保持できます。

.手順
. vCenter Plug-inで、* Management *タブを開きます。
+
** Element vCenterプラグイン5.0以降では、* NetApp Element リモートプラグイン>管理>管理*を選択します。
** Element vCenterプラグイン4.10以前の場合は、* NetApp Element Management > Management *を選択します。


+

NOTE: 複数のクラスタが追加されている場合は、使用するクラスタがナビゲーションバーで選択されていることを確認してください。

. [* Volumes （ボリューム） ] サブタブを選択します。
. 「 * Active * 」ビューで、 Snapshot に使用するボリュームのチェックボックスを選択します。
. [ * アクション * ] を選択します。
. 表示されたメニューで、 * スナップショットの作成 * を選択します。
. （オプション）： Create Snapshot （スナップショットの作成）ダイアログボックスで、スナップショットの名前を入力します。
+

TIP: わかりやすい名前のベストプラクティスを使用してください。これは、環境で複数のクラスタや vCenter Server を使用している場合に特に重要です。Snapshot の名前を入力しなかった場合、デフォルトでは Snapshot の作成日時が名前として使用されます。

. （オプション） * ペアリング時に Snapshot をレプリケーションに含める * チェックボックスをオンにして、親ボリュームがペアリングされたときに Snapshot をレプリケートするようにします。
. Snapshot の保持期間として次のいずれかを選択します。
+
** * 永続的に保持 * ： Snapshot をシステム上に無期限に保持します。
** * 保存期間の設定 * ：システムがスナップショットを保持する期間（日数、時間、または分）を指定します。
+

NOTE: 保持期間には、現在の時刻からの期間を選択します。（保持期間は Snapshot の作成時間からは計算されません）。



. 単一の即時スナップショットを作成するには、 * スナップショットを今すぐ作成 * を選択します。
. スケジュールを設定してあとで Snapshot を作成するには、次の手順を実行します。
+
.. Create snapshot schedule * （スナップショットスケジュールの作成）を選択します。
.. スケジュール名を入力します。
.. スケジュールタイプを選択し、スケジュールの詳細を設定します。
.. （オプション）定期的にスケジュールされたスナップショットを繰り返すには、 *RecurrentSchedule* のチェックボックスをオンにします。


. 「 * OK 」を選択します。




== ボリューム Snapshot の詳細を表示します

必要に応じて、 Snapshot が追加されたことを確認できます。

.手順
. vCenter Plug-inで、* Protection *タブを開きます。
+
** Element vCenterプラグイン5.0以降では、* NetApp Element リモートプラグイン>管理>保護*を選択します。
** Element vCenterプラグイン4.10以前の場合は、* NetApp Element Management > Protection *の順に選択します。


+

NOTE: 複数のクラスタが追加されている場合は、使用するクラスタがナビゲーションバーで選択されていることを確認してください。

. [ * スナップショット * （ Snapshots * ） ] サブタブを選択します。
. （オプション）次のいずれかのフィルタを選択します。
+
** * Individual * ：グループ Snapshot のメンバーではないボリューム Snapshot 。
** * Members * ：グループ Snapshot のメンバーであるボリューム Snapshot 。
** * Inactive * ：削除されたがまだパージされていないボリュームから作成されたボリューム Snapshot 。


. Snapshot の詳細を表示します。




== Snapshot からボリュームをクローニングします

ボリュームの Snapshot から新しいボリュームを作成できます。この処理では、 Snapshot の作成時点でボリュームに含まれていたデータを使用して新しいボリュームをクローニングします。ボリュームの他の Snapshot に関する情報も新しく作成されたボリュームに保存されます。

.手順
. vCenter Plug-inで、vCenter Plug-inから* Protection *タブを開きます。
+
** Element vCenterプラグイン5.0以降では、* NetApp Element リモートプラグイン>管理>保護*を選択します。
** Element vCenterプラグイン4.10以前の場合は、* NetApp Element Management > Protection *の順に選択します。


+

NOTE: 複数のクラスタが追加されている場合は、使用するクラスタがナビゲーションバーで選択されていることを確認してください。

. [ * スナップショット * （ Snapshots * ） ] サブタブを選択します。
. 次の 2 つのビューのいずれかを選択する。
+
** * Individual * ：グループ Snapshot のメンバーではないボリューム Snapshot をリストします。
** * Members * ：グループ Snapshot のメンバーであるボリューム Snapshot をリストします。


. ボリュームとしてクローニングするボリューム Snapshot のチェックボックスを選択します。
. [ * アクション * ] を選択します。
. 表示されたメニューで、 * Clone Volume from Snapshot* （スナップショットからボリュームをクローニング）を選択します。
. ボリューム名と合計サイズを入力し、新しいボリューム用に GB または GiB のいずれかを選択します。
. ボリュームのアクセスタイプを選択します。
+
** * 読み取り専用 * ：読み取り処理のみが許可されます。
** * 読み取り / 書き込み * ：読み取りと書き込みの両方の処理が許可されています。
** * ロック * ：読み取り / 書き込み操作は許可されません。
** * レプリケーションターゲット * ：レプリケートされたボリュームペアのターゲットボリュームとして指定されます。


. 新しいボリュームに関連付けるユーザアカウントを選択します。
. 「 * OK 」を選択します。
. 新しいボリュームを検証します。
+
.. [*管理（* Management）]タブを開きます。
+
*** Element vCenterプラグイン5.0以降では、* NetApp Element リモートプラグイン>管理>管理*を選択します。
*** Element vCenterプラグイン4.10以前の場合は、* NetApp Element Management > Management *を選択します。


.. [* Volumes （ボリューム） ] サブタブを選択します。
.. アクティブ * ビューで、新しいボリュームが表示されていることを確認します。
+

TIP: 必要に応じてページをリフレッシュしてください。







== ボリュームを Snapshot にロールバックします

ボリュームは Snapshot にいつでもロールバックできます。Snapshot の作成後にボリュームに対して行われた変更はすべて元に戻ります。

.手順
. vCenter Plug-inで、* Protection *タブを開きます。
+
** Element vCenterプラグイン5.0以降では、* NetApp Element リモートプラグイン>管理>保護*を選択します。
** Element vCenterプラグイン4.10以前の場合は、* NetApp Element Management > Protection *の順に選択します。


+

NOTE: 複数のクラスタが追加されている場合は、使用するクラスタがナビゲーションバーで選択されていることを確認してください。

. [ * スナップショット * （ Snapshots * ） ] サブタブを選択します。
. 次の 2 つのビューのいずれかを選択する。
+
** * Individual * ：グループ Snapshot のメンバーではないボリューム Snapshot をリストします。
** * Members * ：グループ Snapshot のメンバーであるボリューム Snapshot をリストします。


. ボリュームのロールバックに使用するボリューム Snapshot のチェックボックスを選択します。
. [ * アクション * ] を選択します。
. 表示されたメニューで、 * スナップショットへのボリュームのロールバック * を選択します。
. （オプション） Snapshot にロールバックする前にボリュームの現在の状態を保存するには、次の手順を実行します。
+
.. スナップショットへのロールバックダイアログボックスで、 * ボリュームの現在の状態をスナップショットとして保存 * を選択します。
.. 新しい Snapshot の名前を入力します。


. 「 * OK 」を選択します。




== 外部のオブジェクトストアにボリューム Snapshot をバックアップします

統合型バックアップ機能を使用して、ボリューム Snapshot をバックアップできます。Snapshot は、 NetApp Element ソフトウェアを実行しているクラスタから外部のオブジェクトストア、または Element ベースの別のクラスタにバックアップできます。

Snapshot を外部のオブジェクトストアにバックアップする場合は、オブジェクトストアに接続していて、読み取り / 書き込み処理が許可されている必要があります。

*  up a volume snapshot to an Amazon S3 object store
*  up a volume snapshot to an OpenStack Swift object store
*  up a volume snapshot to a cluster running Element software




=== Amazon S3 オブジェクトストアにボリューム Snapshot をバックアップします

Amazon S3 と互換性のある外部のオブジェクトストアに NetApp Element Snapshot をバックアップできます。

.手順
. vCenter Plug-inで、* Protection *タブを開きます。
+
** Element vCenterプラグイン5.0以降では、* NetApp Element リモートプラグイン>管理>保護*を選択します。
** Element vCenterプラグイン4.10以前の場合は、* NetApp Element Management > Protection *の順に選択します。


+

NOTE: 複数のクラスタが追加されている場合は、使用するクラスタがナビゲーションバーで選択されていることを確認してください。

. [ * スナップショット * （ Snapshots * ） ] サブタブを選択します。
. バックアップするボリューム Snapshot のチェックボックスを選択します。
. [ * アクション * ] を選択します。
. 表示されたメニューで、「 * Backup to * 」を選択します。
. 「 * ボリュームを * にバックアップ」ダイアログで、「 * Amazon S3 * 」を選択します。
. 次のデータ形式で * のオプションを選択します。
+
** * Native * ： NetApp Element ソフトウェアベースのストレージシステムのみが読み取り可能な圧縮形式。
** * Uncompressed * ：他のシステムと互換性がある非圧縮形式。


. 詳細を入力します。
+
** * ホスト名 * ：オブジェクトストアへのアクセスに使用するホスト名を入力します。
** * アクセスキー ID * ：アカウントのアクセスキー ID を入力します。
** * Secret access key * ：アカウントのシークレットアクセスキーを入力します。
** * Amazon S3 Bucket * ：バックアップを格納する S3 バケットを入力します。
** * Prefix * ：（オプション）バックアップ名のプレフィックスを入力します。
** * Nametag * ：（オプション）プレフィックスに追加するネームタグを入力します。


. 「 * OK 」を選択します。




=== OpenStack Swift オブジェクトストアにボリューム Snapshot をバックアップします

OpenStack Swift と互換性のあるセカンダリオブジェクトストアに NetApp Element Snapshot をバックアップできます。

.手順
. vCenter Plug-inで、* Protection *タブを開きます。
+
** Element vCenterプラグイン5.0以降では、* NetApp Element リモートプラグイン>管理>保護*を選択します。
** Element vCenterプラグイン4.10以前の場合は、* NetApp Element Management > Protection *の順に選択します。


+

NOTE: 複数のクラスタが追加されている場合は、使用するクラスタがナビゲーションバーで選択されていることを確認してください。

. [ * スナップショット * （ Snapshots * ） ] サブタブを選択します。
. バックアップするボリューム Snapshot のチェックボックスを選択します。
. [ * アクション * ] を選択します。
. 表示されたメニューで、「 * Backup to * 」を選択します。
. 「 * ボリュームを * にバックアップ」ダイアログで、 * OpenStack Swift * を選択します。
. 次のデータ形式で * のオプションを選択します。
+
** * Native * ： NetApp Element ソフトウェアベースのストレージシステムのみが読み取り可能な圧縮形式。
** * Uncompressed * ：他のシステムと互換性がある非圧縮形式。


. 詳細を入力します。
+
** *URL* ：オブジェクトストアへのアクセスに使用する URL を入力します。
** * ユーザー名 * ：アカウントのユーザー名を入力します。
** * 認証キー * ：アカウントの認証キーを入力します。
** * コンテナ * ：バックアップを保存するコンテナを入力します。
** * Prefix * ：（オプション）バックアップボリューム名のプレフィックスを入力します。
** * Nametag * ：（オプション）プレフィックスに付加する名前タグを入力します。


. 「 * OK 」を選択します。




=== Element ソフトウェアを実行しているクラスタにボリューム Snapshot をバックアップします

NetApp Element ソフトウェアを実行しているクラスタにあるボリューム Snapshot をリモートの Element クラスタにバックアップできます。

バックアップに使用する Snapshot と同じかそれ以上のサイズのデスティネーションクラスタにボリュームを作成する必要があります。

クラスタ間でバックアップまたはリストアを実行する際には、システムによってクラスタ間の認証に使用するキーが生成されます。ソースクラスタはこのボリュームの一括書き込みキーを使用してデスティネーションクラスタに対して認証し、デスティネーションボリュームへの書き込みがセキュリティで保護されます。バックアップまたはリストアのプロセスでは、処理を開始する前に、デスティネーションボリュームからボリュームの一括書き込みキーを生成する必要があります。

.手順
. vCenter Plug-inで、* Management *タブを開きます。
+
** Element vCenterプラグイン5.0以降では、* NetApp Element リモートプラグイン>管理>管理*を選択します。
** Element vCenterプラグイン4.10以前の場合は、* NetApp Element Management > Management *を選択します。
+

NOTE: 複数のクラスタが追加されている場合は、使用するクラスタがナビゲーションバーで選択されていることを確認してください。



. [* VOLUMES * ] サブタブを選択します。
. デスティネーションボリュームのチェックボックスを選択します。
. [ * アクション * ] を選択します。
. 表示されたメニューで、 * リストア元 * を選択します。
. 「 * リストア元 * 」の下のダイアログで、「 * NetApp Element * 」を選択します。
. 次のデータ形式で * のオプションを選択します。
+
** * Native * ： NetApp Element ソフトウェアベースのストレージシステムのみが読み取り可能な圧縮形式。
** * Uncompressed * ：他のシステムと互換性がある非圧縮形式。


. Generate Key * を選択して、デスティネーション・ボリュームの一括ボリューム書き込みキーを生成します。
. ボリュームの一括書き込みキーをクリップボードにコピーします。これは以降のソースクラスタの手順で使用します。
. ソースクラスタを含むvCenterで、* Protection *タブを開きます。
+
** Element vCenterプラグイン5.0以降では、* NetApp Element リモートプラグイン>管理>保護*を選択します。
** Element vCenterプラグイン4.10以前の場合は、* NetApp Element Management > Protection *の順に選択します。


+

NOTE: 複数のクラスタが追加されている場合は、このタスクに使用するクラスタがナビゲーションバーで選択されていることを確認してください。

. バックアップに使用する Snapshot のチェックボックスを選択します。
. [ * アクション * ] を選択します。
. 表示されたメニューで、「 * Backup to * 」を選択します。
. 「 * 音量を * にバックアップ」の下のダイアログボックスで、「 * NetApp Element * 」を選択します。
. デスティネーションクラスタと同じオプションを、 * の下の次のデータ形式で選択します。
. 詳細を入力します。
+
** * リモートクラスタ MVIP * ：デスティネーションボリュームのクラスタの管理仮想 IP アドレスを入力します。
** * リモートクラスタのユーザパスワード * ：リモートクラスタのユーザ名を入力します。
** * リモートユーザのパスワード * ：リモートクラスタのパスワードを入力します。
** * 一括ボリューム書き込みキー * ：以前にデスティネーションクラスタで生成したキーを貼り付けます。


. 「 * OK 」を選択します。




== ボリューム Snapshot を削除します

Plug-in拡張ポイントを使用して、NetApp Element ソフトウェアを実行しているクラスタからボリュームSnapshotを削除できます。Snapshot を削除すると、システムはただちに削除します。

レプリケート中の Snapshot をソースクラスタから削除できます。ターゲットクラスタと同期中の Snapshot を削除すると、同期レプリケーションが完了した時点でソースクラスタから Snapshot が削除されます。ターゲットクラスタからは Snapshot は削除されません。

ターゲットにレプリケート済みの Snapshot をターゲットクラスタから削除することもできます。削除した Snapshot は、ターゲットがソースクラスタで Snapshot が削除されたことを検知するまで、ターゲットの削除済み Snapshot のリストに保持されます。ソース Snapshot が削除されたことをターゲットが検知すると、ターゲットはその Snapshot のレプリケーションを停止します。

.手順
. vCenter Plug-inで、* Protection *タブを開きます。
+
** Element vCenterプラグイン5.0以降では、* NetApp Element リモートプラグイン>管理>保護*を選択します。
** Element vCenterプラグイン4.10以前の場合は、* NetApp Element Management > Protection *の順に選択します。


+

NOTE: 複数のクラスタが追加されている場合は、使用するクラスタがナビゲーションバーで選択されていることを確認してください。

. [ * スナップショット * （ Snapshots * ） ] サブタブで、次のいずれかのビューを選択する。
+
** * Individual * ：グループ Snapshot に属していないボリューム Snapshot のリスト。
** * Inactive * ：削除されたがまだパージされていないボリュームから作成されたボリューム Snapshot のリスト。


. 削除するボリューム Snapshot のチェックボックスを選択します。
. [ * アクション * ] を選択します。
. 表示されたメニューで、 * 削除 * を選択します。
. 操作を確定します。




== 詳細については、こちらをご覧ください

* https://docs.netapp.com/us-en/hci/index.html["NetApp HCI のドキュメント"^]
* https://www.netapp.com/data-storage/solidfire/documentation["SolidFire and Element Resources ページにアクセスします"^]

